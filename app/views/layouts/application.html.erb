<!DOCTYPE html>
<html>
  <head>
    <title>Kit</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'main', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>

    <div id="nav-bar">

      <h1 id="username"><%= @user.name.capitalize %></h1>

      <div id="nav-links">
        <%= link_to 'settings', '#', :onclick => 'showSettings(event);' %><br>
        <%= link_to 'logout', '/logout' %><br><br>
      </div>

      <%= link_to "Channels", '#', :onclick => 'showChannelForm(event);', class: 'nav-links' %><br>

      <div id="channelForm"></div>

      <ul id="channels">
        <% @user.rooms.each do |room| %>
          <% if !room.name.include?('kit') %>
            <li><%= link_to room.name, '#', :onclick => 'showMessages(event);', :data => { :id => "#{room.name}", :class => "channels" } %></li><br>
          <% end %>
        <% end %>
      </ul><hr>

      <%= link_to "Direct Message", search_path, class: 'nav-links' %><br>

      <ul id="contacts">
        <% @user.rooms.each do |room| %>
          <% room.users.each do |user| %>
            <% if user.name != @user.name %>
              <li><%= link_to user.name, '#', :onclick => 'showMessages(event);', :data => { :id => "#{room.name}", :class => "contacts" }%></li><br>
            <% end %>
          <% end %>
        <% end %>
      </ul>

    </div>

    <%= yield %>
    
  </body>
</html>
